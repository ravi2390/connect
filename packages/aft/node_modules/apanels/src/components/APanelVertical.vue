<template>
    <div class="ap-vertical" :class="{ fullscreen: fullscreen }">
        <slot name="top"></slot>
        <slot name="bottom"></slot>
    </div>
</template>

<script>
    export default {
        name: 'APanelVertical',
        props: {
            fixed: { type: Boolean, default: false },
            fullscreen: { type: Boolean, default: false },
        },
        data: () => ({

        }),
        watch: {

        },
        created() {

        },
        mounted() {
            let firstChild = this.$children[0];
            if (firstChild) {
                Object.assign(firstChild.$el.style, {
                    flexGrow: 0,
                    flexShrink: 0,
                });
                if (!this.fixed) {
                    let name = firstChild.$el.id;
                    let sizeStr = window.localStorage.getItem('apanel.' + name);
                    if (name && sizeStr) {
                        let size = JSON.parse(sizeStr);
                        Object.assign(firstChild.$el.style, {
                            height: size.height,
                        });
                    }
                    this.$interact(firstChild.$el).resizable({
                        margin: 6,
                        edges: {bottom: true}
                    })
                        .on('resizemove', event => {
                            Object.assign(event.target.style, {
                                height: `${event.rect.height}px`,
                            });
                            if (event.target.id) {
                                let name = event.target.id;
                                let {width, height} = this.$getElementSizePercent(event.target);
                                window.localStorage.setItem('apanel.' + name, JSON.stringify({width: width + '%', height: height + '%'}));
                            } else if (process.env.NODE_ENV === 'development') {
                                console.log('APanels: Add and #id to this element to preserve sizing');
                            }
                        });
                }
            }
        },
        methods: {

        }
    }
</script>

<style>

</style>
