Field Name,Data Type + Length,Allow NULL value,Is_Primary_Key,Is_Unique_Key,Reference Table for Foreign Key,Default Value,Sample Values (if applicable),Business Rule(s),Definitions (Data Dictionary),Sanitized Function,Is Editable,Display Group,Display Name,Relationship Type
[AffiliateBillHighwayFormId],[int],No,Yes,No,,"IDENTITY(1,1)",,,,,,label:Billhighway Form,Affiliate Form ID,
[AffiliateId],[int],No,No,No,Affiliate(AffiliateId),,,,,,,,Affiliate ID,belongsTo
[AffiliateNumber],[char](5),Yes,No,No,,,,,,,,,Affiliate Number,
[AffiliateName],[varchar](50),Yes,No,No,,,,,,,,,Affiliate Name,
[BillHighwayGroupId],[varchar](50),Yes,No,No,,,,,,,,,BH Group ID,
[BillingTypeName],[varchar](200),Yes,No,No,,,,,,,,,Billing Type Name,
[BillingTypeId],[varchar](50),Yes,No,No,,,,,,,,,Billing Type ID,
[PaymentType],[varchar](50),Yes,No,No,,,,,,,,,Payment Type,
[DuesAmount],[varchar](50),Yes,No,No,,,,,,,,,Dues Amount,
[PaymentFrequency],[varchar](50),Yes,No,No,,,,,,,,,Payment Frequency,
[LocalDescription],[varchar](50),Yes,No,No,,,,,,,,,Local Description,
[NationalDuesCategoryId],[Int],Yes,No,No,,,,,,,,,NationalDuesCategoryId,
[NationalPerCapita],[varchar](50),Yes,No,No,,,,,,,,,National Per Capita,
[StateDuesCategoryId],[Int],Yes,No,No,,,,,,,,,StateDuesCategoryId,
[StatePerCapita],[varchar](50),Yes,No,No,,,,,,,,,State Per Capita,
[AcceptedCreditCard],[varchar](50),Yes,No,No,,,,,,,,,Accepted Credit Card,
[AccountType],[varchar](50),Yes,No,No,,,,,,,,,Account Type,
[AllowWorksiteLocation],[bit],Yes,No,No,,,,,,,,,Allow Worksite Location Lookup,
[BillHighwayMember],[bit],Yes,No,No,,,,,,,,,BillHighway Member,
[BypassDMARC],[bit],Yes,No,No,,,,,,,,,Bypass DMARC,
[CategoryId],[int],Yes,No,No,,,,,,,,,Category ID,
[CCEmail],[varchar](255),Yes,No,No,,,,,,,,,CC Email,
[CopeLanguage],[varchar](max),Yes,No,No,,,,,,,,,Cope Language,
[CopeLanguageDescription],[varchar](max),Yes,No,No,,,,,,,,,Cope Language Description,
[CollectionId],[varchar](255),Yes,No,No,,,,,,,,,Collection ID,
[CollectionType],[varchar](50),Yes,No,No,,,,,,,,,Collection Type,
[FormId],[int],Yes,No,No,,,,,,,,,Form ID,
[FrequencyDescription],[varchar](255),Yes,No,No,,,,,,,,,Frequency Description,
[LegalLanguage],[varchar](max),Yes,No,No,,,,,,,,,Legal Language,
[LegalLanguageDescription],[varchar](max),Yes,No,No,,,,,,,,,Legal LanguagDescription,
[Percentage],[varchar](50),Yes,No,No,,,,,,,,,Percentage,
[PoliticalCollectionName],[varchar](50),Yes,No,No,,,,,,,,,Political Collection Name,
[PreferredCollection],[varchar](50),Yes,No,No,,,,,,,,,Preferred Collection,
[AFTLogo],[bit],Yes,No,No,,,,,,,,,AFT Logo,
[ShowAmount],[bit],Yes,No,No,,,,,,,,,Show Amount,
[ShowFullSSNInPDF],[bit],Yes,No,No,,,,,,,,,Show Full SSN In PDF,
[SSN],[varchar](50),Yes,No,No,,,,,,,,,SSN,
[SendSubmissionEmails],[bit],Yes,No,No,,,,,,,,,Send Submission Emails,
[SubmissionMailDescription],[varchar](max),Yes,No,No,,,,,,,,,Submission Mail Description,
[SubmissionPage],[varchar](255),Yes,No,No,,,,,,,,,Submission Page,
[SubmissionTitle],[varchar](255),Yes,No,No,,,,,,,,,Submission Title,
[SubmissionDate],[datetime],Yes,No,No,,,,,,,,,Submission Date,
,,,,,,,,,,,,,,
SQL,"Select Distinct
[AffiliateBillHighwayFormId] = bdc.BillTypeDuescategoryMappingID,
[AffiliateId] = p.id,
[AffiliateNumber] = bdc.LocalUnionNbr,
[AffiliateName] = vafc.AffiliateName,
[BillHighwayGroupId] = bdc.GroupID,
[BillingTypeName] = bdc.BillingTypeName,
[BillingTypeId] = bdc.BillingTypeId,
[PaymentType] = bdc.PaymentType,
[DuesAmount] = bdc.DuesAmount,
[PaymentFrequency] = bdc.LocalFrequency,
[LocalDescription] = bdc.LocalDescription,
[NationalDuesCategoryId] = mc.id,
[NationalPerCapita] = mc.name,
[StateDuesCategoryId] = null,
[StatePerCapita] = ISNULL(sd.StateDuesCategoryName, bdc.StateDuesCategoryName),
[AcceptedCreditCard] = Null,
[AccountType] = Null,
[AllowWorksiteLocation] = Null,
[BillHighwayMember] = Null,
[BypassDMARC] = Null,
[CategoryId] = Null,
[CCEmail] = Null,
[CopeLanguage] = Null,
[CopeLanguageDescription] = Null,
[CollectionId] = Null,
[CollectionType] = Null,
[FormId] = Null,
[FrequencyDescription] = Null,
[LegalLanguage] = Null,
[LegalLanguageDescription] = Null,
[Percentage] = Null,
[PoliticalCollectionName] = Null,
[PreferredCollection] = Null,
[AFTLogo] = Null,
[ShowAmount] = Null,
[ShowFullSSNInPDF] = Null,
[SSN] = Null,
[SendSubmissionEmails] = Null,
[SubmissionMailDescription] = Null,
[SubmissionPage] = Null,
[SubmissionTitle] = Null,
[SubmissionDate]  = Null,
[CreatedAt] = ISNULL(bdc.cdate, bdc.mdate),
[UpdatedAt] = ISNULL(bdc.mdate, bdc.cdate)
From [BillTypeDuescategoryMapping] bdc (nolock)
inner Join vw_1_affiliate_connect vafc (nolock) on bdc.LocalUnionNbr = vafc.AffiliateNbr
inner join party p	(nolock) on vafc.AffiliateId = p.guid
Left Join membership_category mc	(nolock) on bdc.DuesCategoryId = mc.guid and mc.party_id is NULL and mc.is_deleted = 0
Left Join (select distinct
[StateDuesCategoryId] = mc.id,
[StateDuesCategoryName] = mc.name,
[NationalDuesCategoryId] = mc.national_membership_category_id,
[AffiliateId] = p.Id,
[PaymentFrequencyId] = pf.payment_frequency_id,
a.number,
mc.guid,
ROW_NUMBER() Over (Partition by mc.guid Order by mc.guid) r
from membership_category mc (nolock)
inner join party p (nolock) on mc.party_id = p.id
inner join affiliate a (nolock) on p.id = a.party_id
inner join affiliate_type at (nolock) on a.affiliate_type_id = at.id
Left join membership_category_payment_frequency pf (nolock) on mc.id = pf.membership_category_id and pf.is_deleted=0
where at.affiliate_level_id = 2
and mc.is_deleted = 0
and p.is_deleted=0
and at.is_deleted=0) sd on sd.guid = bdc.StateDuesCategoryId and r = 1",,,,,,,,,,,,,
